.. role:: raw-html-m2r(raw)
   :format: html


Urban System Theory
===================

Urban scaling law
-----------------

About British cities â€“ prior to the industrial revolution, Britain had one big city â€“ London and a plausible hypothesis but we canâ€™t test it because of lack of data, is that then british cities followed a rank size rule. But the cities of the industrial revolution were not formed from a central place theory (which is consistent with Zipf); they were built on the coalfield which is where all the northern cities are. The midlands was built also on coal and iron while Liverpool (as well as Bristol) where the ports. Basically our problems with validating Zipf, scaling size and so on in Britain (England) have something to do with historial development â€“ history matters â€“ or as we say in complexity theory, the evolution of the city system is path dependent

Fabulous question Zhengzi! This is another limitation of this type of analysis, it does not take into account the interaction between cities. But of course it matters, since this is linked to growth and spillovers, so the task is to find the impact, and this is still a research question!

There are really three types if scaling at least 1) inverse power laws that relate to size distributions like cities â€“ Zipf â€“  2) scaling power laws that relate one variable to another â€“ say income as a function of population â€“ allometry â€“ but there is a third â€“ that we havenâ€™t talked about today that is really important and central to spatial interaction â€“ gravity transport models â€“ the inverse square law that relates to what you are saying I think and we will look at this in urban simulation

Geography Information Science
=============================

Spatial Patterns and Spatial Autocorrelation
--------------------------------------------


* The importance of pattern
* Patterns of categorical point data â€“ Point Pattern Analysis

  * Quadrat Analysis
  * Ripley's K
  * DBSCAN

* Patterns of spatially referenced continuous observations

  * Spatial autocorrelation
  * Defining near and distant things
  * Measuring spatial autocorrelation

    * Moran's I
    * LISA

The importance of pattern
^^^^^^^^^^^^^^^^^^^^^^^^^

Discrete Objects: Point Pattern Analysis
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

*John Snow* : Broad street pump

Quadrat Analysis
~~~~~~~~~~~~~~~~

Ripley's K
~~~~~~~~~~

DBSCAN
~~~~~~

`Landscapetoolbox <https://wiki.landscapetoolbox.org/doku.php/spatial_analysis_methods:home>`_

Continuous Objects:
^^^^^^^^^^^^^^^^^^^

Spatial autocorrelation
~~~~~~~~~~~~~~~~~~~~~~~

`GeoDa <https://geodacenter.github.io/documentation.html>`_

Defining near and distant things
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Measuring spatial autocorrelation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Moran's I
"""""""""

LISA
""""

Quantitative Methods
====================

An Introduction to Quantitative Thinking
----------------------------------------


#. Understand the structure and focus of the module.
#. Consider the different roles of quantitative methods and their relevance in your work.
#. Develop a method for tackling quantitative problems.
#. Consider how to formulate a research question and structure a piece of quantitative writing.


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201107210923020.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201107210923020.png
   :alt: 


Fermi Estimation Problems
^^^^^^^^^^^^^^^^^^^^^^^^^

A process for tackling questions
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


#. State Assumptions.
#. Establish what you know (facts, formulae etc).
#. Establish what you don't know, but need to know.
#. Sort out 3 by estimating, calculating or researching.
#. Put all back together to get an answer.
#. Think about whether your answer is sensible. Verify if possible.

Good practice of a quantitative essay
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Introduction
~~~~~~~~~~~~


* 
  Gives the reader a feel for your investigation.

* 
  Begins to justify your investigation


.. image:: http://www.zzzhou.me/images/2020/11/10/clip_image001.png
   :target: http://www.zzzhou.me/images/2020/11/10/clip_image001.png
   :alt: 


Literature Review
~~~~~~~~~~~~~~~~~


* Sources for context vs.Â sources for methods
* Is all the literature relevant to your investigation?
* How has your reading informed your methodology?
* Demonstrates the importance of your investigation
* Takes a critical perspective 
* (Engaging narrative)
* don't cite wikipedia


.. image:: http://www.zzzhou.me/images/2020/11/10/clip_image002.png
   :target: http://www.zzzhou.me/images/2020/11/10/clip_image002.png
   :alt: 


Research question
~~~~~~~~~~~~~~~~~


* explicit
* precise

  * real world relevance
  * informed by literature review
  * possibly split into sub-questions

Presentation of data
~~~~~~~~~~~~~~~~~~~~


* explains and visualize your data for the reader

Methodology
~~~~~~~~~~~


* Precise
* Reproducible
* Explicitly informed by literature review
* Explicitly designed to answer research question


.. image:: http://www.zzzhou.me/images/2020/11/10/clip_image003.png
   :target: http://www.zzzhou.me/images/2020/11/10/clip_image003.png
   :alt: 


Results
~~~~~~~


* Clear
* Complete
* Minimal Text
* Presented in most informative way possible

Discussion
~~~~~~~~~~


* Highlights key points from results
* Interprets and synthesises
* Acknowledges limitations
* Relates back to research question

Conclusion
~~~~~~~~~~


* Explicitly answers research question (as far as possible)
* Proposes further research


.. image:: http://www.zzzhou.me/images/2020/11/10/clip_image004.png
   :target: http://www.zzzhou.me/images/2020/11/10/clip_image004.png
   :alt: 


Overall Style
~~~~~~~~~~~~~


* Impersonal
  Use "we" or the passive ("A simulation was run.")
  Never use "I"
* 
  Not narrative
  Your Goal -- Communicate your results
  Not your goal -- Describe your every thought and action in chronological order

* 
  OBJECTIVES


  #. Understand the structure and focus of the course.
  #. Consider the different roles of quantitative methods and their relevance in your work.
  #. Develop a method for tackling quantitative problems.
  #. Consider how to formulate a research question and structure a piece of quantitative writing.

A Good Research Question...
^^^^^^^^^^^^^^^^^^^^^^^^^^^


* ... cannot be answered with a single calculation ;
* ... is not vague ; (it could be quite long to include detail precision)
* ... asks about the real world, not just about data or methods.
* ... is interesting and valuable.
* ... is ambitious.

Lecture 1 -- Assignment
^^^^^^^^^^^^^^^^^^^^^^^

Read one of the example QM Projects* provided on Moodle. With reference to the mark scheme for written work, consider what mark you would award to the project in the streams 'Context and Review' and Communication'. Come to the next lecture prepared to talk about your chosen mark and why you have awarded it. (You may not understand the techniques used, but do not worry about this. Focus on the structure and the way that literature is used to support the work.)

Approaching & Communicating Data
--------------------------------

Objectives
^^^^^^^^^^


#. Understand basic data types 4ä¸­æ•°æ®ç±»å‹
#. Consider how to summarise and represent data. æ•°æ®æè¿°æ–¹å¼
#. Understand basic distributions of data. 4ç§åˆ†å¸ƒ
#. Recognise three types of relationship between data series ä¸‰ç§å…³ç³»

Assignment Discussion
^^^^^^^^^^^^^^^^^^^^^

Data types
^^^^^^^^^^

Source : `Level of measurement <https://en.wikipedia.org/wiki/Level_of_measurement>`_


* æœ‰åºå˜é‡å¯ç”¨å‡å€¼ï¼Ÿé—´éš”å˜é‡å¯ç”¨å‡å€¼ï¼Ÿ
* 2020å¹´æ˜¯1010å¹´çš„ä¸¤å€ å¹´åœ¨åšæ ‡å¿—å’Œåšåº¦é‡çš„åŒºåˆ«


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201108104339605.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201108104339605.png
   :alt: 


Nominal data åä¹‰å˜é‡
~~~~~~~~~~~~~~~~~~~~~


* Differentiates items based only on namesï¼› No orderï¼›Also called categorical data
* Example:

  * names, gender, country names
  * åœŸåœ°åˆ©ç”¨åˆ†ç±»æ•°æ®

* Descriptive methods

  * Equality: 'apple' is not 'pear', 'apple' is 'apple'
  * Mode (the most common item)

Ordinal data æœ‰åºå˜é‡
~~~~~~~~~~~~~~~~~~~~~


* Allow for rank order, but not the relative degree of difference
* Example

  * measurement of opinions
  * é«˜ä¸­ä½ç¨‹åº¦

* Descriptive methods

  * Equality Mode
  * The median: middle-ranked item
  * Differences do not make sense, nor do means.

Interval data é—´éš”å˜é‡
~~~~~~~~~~~~~~~~~~~~~~


* Allow for the degree of difference between items, but not the ratio between them. The zero value is arbitrary.
* Example

  * temperature with the Celsius scale
  * æ—¥æœŸ

* Descriptive methods

  * Equality, mode, median
  * Addition, Arithmetic mean
  * Ratio? The coordinate of 8 is twice as far as that of 4

    * ä¸èƒ½è¯´20åº¦æ˜¯10åº¦çš„ä¸¤å€çƒ­

Ratio data æ¯”ç‡å˜é‡
~~~~~~~~~~~~~~~~~~~


* Allow for ratio between items; The zero value is unique and non-arbitrary.
* Example

  * mass, length, energy

* Descriptive methods

  * Equality, mode, median, arithmetic mean
  * Ratio

Descriptive statistics
^^^^^^^^^^^^^^^^^^^^^^

Mean median and mode
~~~~~~~~~~~~~~~~~~~~

https://statisticsbyjim.com/basics/measures-central-tendency-mean-median-mode/


* Outliers and skewed data have a smaller effect on the median

  * **When to use the median**\ :
    `Skewed <https://statisticsbyjim.com/glossary/skewed-data/>`_
    distribution, Continuous data, `Ordinal data <https://statisticsbyjim.com/glossary/ordinal-variables/>`_
  * **When to use the mode**\ :
    `Categorical data <https://statisticsbyjim.com/glossary/categorical-variables/>`_\ ,
    Ordinal data, Count data, Probability Distributions

* å¯¹äºæ­£æ€åˆ†å¸ƒï¼Œä¸‰è€…æ— å·®å¼‚ï¼›åæ€åˆ†å¸ƒï¼Œä¸­ä½æ•°è¾ƒå¥½ï¼›æœ‰åºæ•°æ®ï¼Œä¸­ä½æ•°æˆ–è€…ä¼—æ•°è¾ƒå¥½ï¼›ä¼—æ•°å¯ä»¥é€šè¿‡å¯†åº¦åˆ†å¸ƒè®¡ç®—

About DP and SF
~~~~~~~~~~~~~~~

â€¢ DP: decimal places 
â€¢ SF: significant figures

Variance and std: Quantifying Spread
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Sample and Population
"""""""""""""""""""""

https://online.stat.psu.edu/stat200/book/export/html/21

.. image:: https://online.stat.psu.edu/stat200/sites/stat200/files/inline-images/InferenceGraphicSU17.png
   :target: https://online.stat.psu.edu/stat200/sites/stat200/files/inline-images/InferenceGraphicSU17.png
   :alt: 


Bessel's Correction
"""""""""""""""""""


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201108083413348.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201108083413348.png
   :alt: 



* æ ·æœ¬ï¼š n-1
* å…¨é›†ï¼š n

Visualizing data
^^^^^^^^^^^^^^^^

Outliers
~~~~~~~~


* Tukey Fences

$$
IQR = UQ-LQ 
LQ - 1.5\times IQR,UQ+1.5\times IQR
$$

Boxplot
~~~~~~~

.. code-block:: python

   ## This program creates a boxplot from data stored in a csv file and saves it as a png image.

   ## The data file must be one column of numbers - no column labels, etc.
   ## It must be saved as a csv file (e.g. use "Save As" in Excel and choose csv format).
   ## It must be saved in the same folder as this program.
   ## See the file sample_boxplot_data.csv for reference.

   ## In the next line, replace sample_boxplot_data.csv with the filename of your data:
   data_filename = 'sample_boxplot_data.csv'

   ## In the next line, replace boxplot with the filename you wish to save as:
   output_filename = 'boxplot.png'

   ## Use the next line to set figure height and width (experiment to check the scale):
   figure_width, figure_height = 4,10

   ## You can ignore these two lines:
   import matplotlib.pyplot as plt
   import numpy as np

   data = np.genfromtxt(data_filename)

   ## If there are errors importing the data, you can also copy the data in as a list.
   ## e.g. data = [1.95878982, 2.59203983, 1.22704688, ...]

   ## This line creates the figure. 
   plt.figure(figsize=(figure_width,figure_height))

   ## Uncomment the next three lines to set the axis limits (otherwise they will be set automatically):
   ##axis_min = 0.95
   ##axis_max = 4.05
   ##plt.ylim([axis_min,axis_max])

   ## The next lines create and save the plot:
   plt.xlim([0.75,1.25])
   plt.xticks([])
   plt.boxplot(data, manage_ticks=(False))
   plt.savefig(output_filename)

Distributions
^^^^^^^^^^^^^


* mean,median,mode å’Œ boxplot æ˜¯å¯¹äºæ•°æ®çš„é€šç”¨æ–¹æ³•ï¼Œç®€å•æ–¹æ³•
* å¦ä¸€ç§æè¿°æ•°æ®çš„æ–¹æ³•-- probability distribution Probability density  function
* æ¦‚ç‡åˆ†å¸ƒä¸ç›´æ–¹å›¾çš„åŒºåˆ«ï¼Ÿ

  * å¦‚æœè¦æè¿°æ ·æœ¬ï¼Œåˆ™ä½¿ç”¨ç»éªŒåˆ†å¸ƒï¼ˆå³ç›´æ–¹å›¾ï¼‰ï¼Œå¦‚æœè¦æè¿°å‡è®¾çš„åŸºç¡€åˆ†å¸ƒï¼Œåˆ™ä½¿ç”¨pdfã€‚
  * æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆpmfï¼‰é’ˆå¯¹çš„æ˜¯ç¦»æ•£å˜é‡ï¼Œä¾‹å¦‚æ³Šæ¾åˆ†å¸ƒã€‚
  * å¤§å­¦è¯¾ç¨‹ https://ocw.tudelft.nl/courses/observation-theory-estimating-unknown/

* å¦‚ä½•åˆ¤æ–­æ˜¯å¦åˆ†å¸ƒ

  * å›¾å½¢éªŒè¯

    * ç›´æ–¹å›¾
    * pdf
    * ç»éªŒç´¯ç§¯æ¦‚ç‡å›¾ : ä¹Ÿèƒ½æ‹Ÿåˆå…¶ä»–åˆ†å¸ƒ
    * å˜æ¢åæ ‡è½´çš„ç»éªŒç´¯ç§¯æ¦‚ç‡å›¾
    * P-På›¾å’ŒQ-Qå›¾

  * ç»Ÿè®¡æ£€éªŒ

    * Kolmogorov-Smirnovæ£€éªŒ
    * Anderson-Darlingæ£€éªŒ
    * Shapiro-Wilkæ£€éªŒ

* https://docs.scipy.org/doc/scipy/reference/stats.html

Normal Distribution
~~~~~~~~~~~~~~~~~~~

Log-normal
~~~~~~~~~~


* ä¸å¯å°äº0 ä¸€äº›å€¼éå¸¸å¤§


.. image:: https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/PDF-log_normal_distributions.svg/600px-PDF-log_normal_distributions.svg.png
   :target: https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/PDF-log_normal_distributions.svg/600px-PDF-log_normal_distributions.svg.png
   :alt: 


Poisson
~~~~~~~


* Poisson Distribution gives the probability of k events.
* how many times things happen?
* 
  .. image:: https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Poisson_pmf.svg/650px-Poisson_pmf.svg.png
     :target: https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Poisson_pmf.svg/650px-Poisson_pmf.svg.png
     :alt: 

Exponential distribution
~~~~~~~~~~~~~~~~~~~~~~~~


* The Exponential distribution is linked to the Poisson distribution.
* If the Poisson measures the probability of x events within a time period, then the Exponential measures how long we are likely to wait between events.
* So imagine an emergency room in a hospital. The exponential distribution will tell us how likely we are to wait x amount of time from one patient arriving to the next.

:raw-html-m2r:`<u>Guessing Distribution</u>`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


#. Shoe size normal
#. The thickness of tree bark lognormal
#. The number of times a website is accessed per minute. poisson
#. The time between phone calls at a call centre. exponential
#. The number of popcorn kernels popping in a 5 second window
   **normal** ï¼Ÿï¼Ÿ poisson

   * è¿™æ˜¯ä¸ªæ—¶é—´åºåˆ—è€Œä¸æ˜¯å•ä½æ—¶é—´å‘ç”Ÿçš„æ¬¡æ•°

https://www.youtube.com/watch?v=YmOsDTczOFs&ab_channel=MindYourDecisions

Boxcox transformæ–¹æ³•
~~~~~~~~~~~~~~~~~~~~


* åªæ˜¯ä¸€ç§å°†æ•°æ®è½¬æ¢ä¸ºæ­£æ€åˆ†å¸ƒçš„æ–¹æ³•
* æ”¹å˜äº†æ•°æ®çš„æ„ä¹‰

Relationships
^^^^^^^^^^^^^


* ä¸‰ç§å…³ç³»
* å¦‚ä½•åˆ¤æ–­å…³ç³»

  * using logarithms to straighten curves
  * If your data makes a straight line on a log-linear plot, it may be an exponential relationship
  * If your data makes a straight line on a log-log plot, it may be an power law relationship
  * å¦‚æœæ•°æ®åœ¨yå¯¹æ•°å›¾ä¸Šæ˜¯ä¸€æ¡ç›´çº¿ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½æ˜¯æŒ‡æ•°å…³ç³»
  * åŒå¯¹æ•°å›¾ä¸Š-- å¹‚å¾‹

* zipf's law

Linear
~~~~~~

Bus stops in a line road and in a spatial circle

Kleiber's Law and power law
~~~~~~~~~~~~~~~~~~~~~~~~~~~

$$
Metabolic rate = M \times x^{n} \
x: body mass\
n: power
$$
Power law


* for Cities
* Linear relationships are power laws!
* å¯¹äºå¹‚å¾‹ï¼Œè¿™ç§å…³ç³»å¯èƒ½åªé€‚ç”¨äºè¶…è¿‡ä¸€å®šå¤§å°çš„å€¼ã€‚è€ƒè™‘å¿½ç•¥å°çš„ä»·å€¼
* å¯¹äºæ—¶é—´æ•°æ®(ä¾‹å¦‚å¹´ä»½)ï¼Œå¯èƒ½æ²¡æœ‰è‡ªç„¶çš„"é›¶"ã€‚è€ƒè™‘ä»ä¸€ä¸ªåˆç†çš„åŸºå‡†æ—¶é—´åº¦é‡ã€‚(ä¾‹å¦‚ï¼Œå¦‚æœæ•°æ®å§‹äº1900å¹´ï¼Œä½¿ç”¨"è‡ª1900å¹´ä»¥æ¥çš„å¹´ä»½")
* kleiber's lawéƒ½æ˜¯power law çš„ç‰¹æ®Š
* zipf's law

Exponentials
~~~~~~~~~~~~

..

   " The greatest shortcoming of the human race is our inability to understand the exponential function

   â€‹                                                                                                                                                         -- Albert Bartlett


----

:raw-html-m2r:`<u>Suggested Reading/Viewing</u>`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


* lectures
* `Padlet for disscussion qm projects <https://padlet.com/hannahfry/bbua7lcjtkyq6mh4>`_
* `Logarithms from Khan Academy <https://www.khanacademy.org/math/algebra2-2018/exponential-and-logarithmic-functions/introduction-to-logarithms/v/logarithms>`_
* Assignments

----

Basic Mathematical Catch-Up


* Introduction to logarithms: http://www.purplemath.com/modules/logs.htm
* A straightforward discussion of variance and standard deviation: averages, their advantages and disadvantages: 
* Box plots: http://www.physics.csbsju.edu/stats/box2.html

Variance - Deeper Thinking


* For those who know a bit of stats and have read that the sample variance should use n-1 as a divisor:
  http://www.crataegus.me.uk/thoughts/bessel_correction.html

Excel Tutorial


* For those not comfortable with Excel, here is a short entry-level tutorial on using Excel formulae:
  http://www.excel-easy.com/introduction/formulas-functions.html
* That site has loads more Excel advice, so have a look around there if you like.

Power Laws


* A TED talk on power laws for cities, given by one of the authors of the paper that I referred to in the lecture. Entertaining, relevant and informative and only 17 minutes long: https://www.ted.com/talks/geoffrey_west_the_surprising_math_of_cities_and_corporations\##t-173864
* Here is a nice tutorial on power laws and log-log plots from the University of Plymouth. It goes into a little more detail than we did, so it is good for people who had trouble following (skip the bits that don't relate to what was covered in the lecture) or who are confident and want to extend/test their knowledge.http://www.reading.ac.uk/AcaDepts/sp/PPLATO/imp/interactive%20mathematics/loglog2.pdf
* Here is an academic paper on power laws in cities. It is well worth a read for background knowledge, but do not worry if you do not understand all of it (skip the mathematical section: "Urban Growth Equation" on p7304, unless you are a mathematician or a masochist). http://www.pnas.org/content/104/17/7301.full.pdf
* There is also an accessible summary of the paper here:http://scienceblogs.com/purepedantry/2007/10/18/power-laws-and-cities/
* But note that there is a mistake in that summary. When they talk about "exponential" increases, they mean "superlinear". The academic paper does not discuss any exponential relationships.

----

Distributions

**Light Accessible Reading/Viewing**

Zipf's Law:


* https://plus.maths.org/content/mystery-zipf
* http://io9.com/the-mysterious-law-that-governs-the-size-of-your-city-1479244159
  Video: https://youtu.be/fCn8zs912OE?t=4

**Tutorials**
Poisson Distribution (Good accessible overview):
https://www.umass.edu/wsp/resources/poisson/
Stat Trek on Distributions:
http://stattrek.com/probability-distributions/probability-distribution.aspx?Tutorial=Stat
Normal Distribution (In significant depth):
http://onlinestatbook.com/2/normal_distribution/intro.html

**More Technical Background**
Lognormal across the
sciences:http://stat.ethz.ch/~stahel/lognormal/bioscience.pdf
Working with Power Laws:


* `http://www-personal.umich.edu/~mejn/courses/2006/cmplxsys899/powerlaws.pd <http://www-personal.umich.edu/~mejn/courses/2006/cmplxsys899/powerlaws.pdf>`_
* https://arxiv.org/pdf/0706.1062.pdf

**Further Academic Papers**
There is More than a Power Law in Zipf: http://www.nature.com/articles/srep00812

----

Albert Bartlett's lecture:https://youtu.be/O133ppiVnWY
BBC article on population projections: http://news.bbc.co.uk/1/hi/8000402.stm
Telegraph article on oil: http://www.telegraph.co.uk/news/earth/energy/oil/9867659/Why-the-world-isnt-running-out-of-oil.html

Assignment
^^^^^^^^^^


#. Watch Albert Bartlett's lecture on the exponential function: http://www.youtube.com/watch?v=F-QA2rkpBSY (You only need to watch the first 20 minutes or so.)
   Read the following articles:http://news.bbc.co.uk/1/hi/magazine/8000402.stm
   http://www.telegraph.co.uk/news/earth/energy/oil/9867659/Why-the-world-isnt-running-out-of-oil.html
   Consider what we should conclude about quantitative predictions?
#. Have a play with the excel data investigation. It will guide you through how to plot and explore data in Excel.
#. Look at the relationships data sets on moodle. What do they reveal about the underlying relationships?

Measuring Relationships
-----------------------

Objectives
^^^^^^^^^^


#. Understand the concept of covariance, correlation and what it says about data relationships. 
#. Be able to measure a data relationship using simple linear regression. 
#. Learn how regression can be extended for data with more than two dimensions. 
#. Understand how to identify whether additional data provides additional information.

Lectures
~~~~~~~~

How many ways do we have to measure correlation? What are the main differences between these measurements? What is partial correlation and how can we understand it intuitively?
We can't use correlation to predict, as correlation does not imply causation, but if variables are dependent then they are either causal to each other (in either direction) or driven by a common driver.
Do we need to perform a heteroskedasticity test before regression, and how can we do this?


* data type
* distribution
* relationship
* regression

Motivations for data transformation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


#. To formulate a different question
#. To meet the assumptions of a statistical inference procedure
#. To make data easier to visualise

Outliers and Dealing with it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~


* å…ˆç”¨æ–¹æ³•è¯†åˆ«outliers ï¼Œæ ¹æ®ç»éªŒåˆ¤æ–­æ˜¯å¦ä¿ç•™
* types of outliers

  #. Error
  #. Points not following the pattern

     * If you are studying the overall pattern, they need to be removed -- e.g. City of London (in London) -- e.g. Vantican City (1000 pop, gender ratio 7:1)
     * "Statistical oddities"

  #. Points that are essential to the overall pattern

     * Don't remove them e.g. New York in Uï¼³ pop data

* There are many approaches to identify outliers (e.g. Tukey fences), but determining an outlier is a subjective exercise.
* Dealing with outliers (not sure type 2 or 3)

  * Retention, **but the application should use methods that are robust to outlier points**
  * Exclusion. If some outliers are excluded, the reasons should be clearly stated on the report.

----

Part 1. Covariance, Correlation, and Association
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Variability
~~~~~~~~~~~

a single variable
"""""""""""""""""

Co-variability of two variables
"""""""""""""""""""""""""""""""

ANOVA (not covered here)
""""""""""""""""""""""""

â€¢ Whether two or more population means are equal â€¢ When there are only two populations, it is called two sample t-test (covered in Lecture 5) 
â€¢ E.g. is the mortality rate of Covid-19 the same across different cities?

Covariance
""""""""""

"Do the two variables change in the same direction?" "To what extent do they change together?"


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201020174858181.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201020174858181.png
   :alt: 



* Meaning
* Meaning of sign
* Range? -inf~inf
* Normalised?  no 
* Symmetric

Larger Variance  


.. image:: http://www.zzzhou.me/images/2020/11/12/image-20201112225329571.png
   :target: http://www.zzzhou.me/images/2020/11/12/image-20201112225329571.png
   :alt: image-20201112225329571


Correlation
~~~~~~~~~~~

Person Correlation
""""""""""""""""""

$$
cor(X,Y) = r(X,Y) = \frac{cov(X,Y)}{std(X)\times std(Y)}
$$

**limitations**


* The Pearson correlation coefficient measures only **linear association**\ : how nearly the data fall on a straight line.
* It is not a good summary of association if the scatterplot has a nonlinear (curved) pattern.
* When you present the correlation, remember to present a scatterplot.
* The Pearson correlation coefficient is appropriate only for interval or ratio variables, not nominal or ordinal variables -- even if their values are numerical.
* Note the difference between the data type of the variable and the value.


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201020174836667.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201020174836667.png
   :alt: image-20201020174836667


Spearman's Rank Correlation Coefficient
"""""""""""""""""""""""""""""""""""""""

$$
r\ *{s}=\rho*\ {\mathrm{rg}\ *{X}, \mathrm{rg}*\ {Y}}=\frac{\operatorname{cov}\left(\mathrm{rg}\ *{X}, \mathrm{rg}*\ {Y}\right)}{\sigma\ *{\mathrm{rg}*\ {X}} \sigma\ *{\mathrm{rg}*\ {Y}}}
$$


* It is applicable for interval/ratio data

  * Transform the value into ranks;
  * Calculate the Rank correlation.

* But it is different from Pearson's correlation, and they are
  incomparable.
* 
  Less sensitive to outliers than Pearson correlation


  .. image:: http://www.zzzhou.me/images/2020/11/10/image-20201020175750498.png
     :target: http://www.zzzhou.me/images/2020/11/10/image-20201020175750498.png
     :alt: 


Limitations
"""""""""""


* Pearson correlation is not applicable for nominal/ordinal data.
* It measures only linear association, and is not a good summary for non-linear data.
* It is a measure of association, not causation. It is not robust to outliers, less robust than Spearman's rank correlation.

correlation is a global metric, it doesn't give the local relation.

----

Part 2. Linear Regression
^^^^^^^^^^^^^^^^^^^^^^^^^


#. Where to place the line?
#. How well does the line represent the data?


.. image:: http://www.zzzhou.me/images/2020/11/10/image-20201020181527698.png
   :target: http://www.zzzhou.me/images/2020/11/10/image-20201020181527698.png
   :alt: 


Necessary Conditions
~~~~~~~~~~~~~~~~~~~~


* Linear relationship exists
* Independent errors : one error is not affected by the value of another error 
* Normally distributed errors : for each value of x, the errors have a normal distribution about the regression line.
* Equal error variance for all x values :  the error value does not change because of the x values

NOT a Necessary Condition! : Normally Distributed Data

verifying the conditions

residual independent 

normally distributed 

equal variance

Linear regression exists
~~~~~~~~~~~~~~~~~~~~~~~~

The relationship between y and x is linear; that is, there is an equation, y=mx+c+Îµ that constitutes the population model.

Independent errors
~~~~~~~~~~~~~~~~~~


* The residuals are independent; the value of one error is not affected by the value of another error.
* In probability, two events A and B are independent if knowing that B happens does not alter the probability that A happens. E.g. , flipping two coins.
* A and B are independent if Pr[B]=0 or Pr[A|B] = Pr[A]
* But... how can we know that?

Normally distributed errors
~~~~~~~~~~~~~~~~~~~~~~~~~~~


* For each value of x, the errors have a normal distribution about the regression line. This normal distribution is centred on the regression line.
* It may be written as Îµ~ğ‘(0, Ïƒ2)

Equal error variance for all x values
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


* The errors about the regression line do not vary with x; that is, V[Îµ|x] = Ïƒ2 residual plot

Part 3. Multiple Regression
^^^^^^^^^^^^^^^^^^^^^^^^^^^


#. Can we combine greenery and natural light to create a model for predicting wellbeing?
#. How does the combined model compare with individual models?
#. Can we put categorical variables into the model?

Question 1
""""""""""

With R2 values of 30-40%, both models leave a lot of variation unaccounted for. Could we do better, by using BOTH data series to explain the variation in the reported well-being?

Readings
^^^^^^^^

Tools and Techniques
~~~~~~~~~~~~~~~~~~~~

**Covariance and Correlation:**\ http://ci.columbia.edu/ci/premba_test/c0331/s7/s7_5.html
**Spearman's Rank Correlation Coefficient:**\ https://statistics.laerd.com/statistical-guides/spearmans-rank-order-correlation-statistical-guide.php

*As an aside, while there are lots of Spearman's Rank information resources online, it is difficult to find one that does not make misleading claims about (surprise, surprise) normality assumptions. Many resources claim that you would use Spearman rather than Pearson correlation if you think your data series are not normally distributed.
This is false. Pearson correlation does not require normally distributed data (though some associated statistical tests do). The following two resources, for example, would also be good if it were not for such claims:*

http://www.statstutor.ac.uk/resources/uploaded/spearmans.pdf
http://www.biostathandbook.com/spearman.html

**Linear Regression - Tutorials**
Here is an excellent course on regression. I would recommend that you use it as your main reference work for this subject. Lessons 1, 3 and 4 are most relevant to simple linear regression:
https://onlinecourses.science.psu.edu/stat501/lesson/1
`https://onlinecourses.science.psu.edu/stat501/lesson/3 <https://onlinecourses.science.psu.edu/stat501/lesson/1>`_
`https://onlinecourses.science.psu.edu/stat501/lesson/4 <https://onlinecourses.science.psu.edu/stat501/lesson/1>`_

The course also goes through multiple linear regression (Lessons 5-7) and discusses the use of categorical variables in detail (Lesson 8):
`https://onlinecourses.science.psu.edu/stat501/lesson/5 <https://onlinecourses.science.psu.edu/stat501/lesson/1>`_
`https://onlinecourses.science.psu.edu/stat501/lesson/6 <https://onlinecourses.science.psu.edu/stat501/lesson/1>`_
`https://onlinecourses.science.psu.edu/stat501/lesson/ <https://onlinecourses.science.psu.edu/stat501/lesson/1>`_\ 7

Here is a lesson on performing simple and multiple linear regression in Python. It is a lot more advanced than the Python we have covered, but may be of interest for those who are fairly confident with the language:
http://www.dataschool.io/linear-regression-in-python/

Stat Trek (http://stattrek.com/) is another good site for learning about concepts in statistics. Here is the start of their material on regression: http://stattrek.com/regression/linear-regression.aspx?Tutorial=Stat

[However, note that Stat Trek say "For any given value of X... the Y values [must be] roughly normally distributed", which is true (this is effectively equivalent to saying that the residuals must be normally
distributed), but they then imply that looking at a histogram of the data would help to confirm this, which is of course false. The histogram might show that the DATA looks normally distributed, but as we now know,  this is irrelevant! It's a residuals vs fits plot you need.]

Research Skills
~~~~~~~~~~~~~~~

UCL Library's video series on using Web of Science to search for academic publications
https://youtu.be/AgTk3kA

Just for fun
~~~~~~~~~~~~

Spurious Correlations: http://www.tylervigen.com/spurious-correlations
The Great Horse Manure Crisis:http://www.historic-uk.com/HistoryUK/HistoryofBritain/Great-Horse-Manure-Crisis-of-1894/

Advanced Regression
-------------------


* å›å½’éœ€ä¸éœ€è¦å˜é‡æ­£æ€åŒ–ï¼Ÿä»€ä¹ˆæ—¶å€™éœ€è¦æ­£æ€åŒ–ï¼Œæ ‡å‡†åŒ–

Assignment 1
------------

Hypothesis Testing
------------------

**1.**  State your hypotheses.

**2.**  State your significance level: ğ›‚

**3.**  What is the evidence (E)? (The Test Statistic)

**4.**  Calculate the probability of seeing evidence at least  as extreme as E, *if* H0 *is true*. (The â€œp-valueâ€)

**5.** If the p-value is smaller than the significance, reject  H0 and accept H1. Otherwise there is not enough  evidence to reject H0.


.. image:: http://www.zzzhou.me/images/2020/11/17/image-20201117181037540.png
   :target: http://www.zzzhou.me/images/2020/11/17/image-20201117181037540.png
   :alt: image-20201117181037540


Chi squared å¼€ threshold

what chance of getting these observed values?

Quiz


#. 
#. two 
#. a firm discrimination between 


* 

Cluster Analysis
----------------

Part 1: Hypothesis testing recap
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Yes, the first question is whether your INDEPENDENT variable is categorical or quantitative. The second is whether your DEPENDENT variable categorical or quantitative.

0.01 0.05 p value 

Part 2: Cluster analysis â€“ why should I care?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Sorry, I am always get confused about the difference among Boxcox transformation, log transformation, z-scores and  standardisation, it seems that all of these are transforming things on the same scale, how to choose the proper method?

Sorry, I am always confused about the difference between Boxcox transformation, log transformation, z-scores, and standardization. It seems that all of these are transforming things on the same scale. How to choose the proper method?

Will the converted data lose some features

Part 3: Before you start
^^^^^^^^^^^^^^^^^^^^^^^^

å¦‚ä½•æ¯”è¾ƒè°æ›´å¼‚å¸¸ï¼Ÿ

æ ‡å‡†åŒ–ä¸ä¼šæŸå¤±ç‰¹å¾

Part 5: Hierarchical clustering
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Part 6: How good are your clusters?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Part 7: Some tips and tricks for your written work
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Optimising Limited Resources
----------------------------

Modelling the World
-------------------

Statistical Traps & Advanced Topics
-----------------------------------

wk4
---


* VIF for multicollinearity

Introduction to Programming
===========================

Week 6ï¼šSpatial Data
--------------------

Lectures
^^^^^^^^

Mapping
~~~~~~~


* Purely Computational vs. Mostly Computational

  * Wider variety of output formats (e.g. Atlases, 3D/web).
  * Better support for 'finishing touches' (e.g. scalebars, north arrows, rule-based labels, etc.).
  * Better-quality output for less effort (e.g. Model Builder + QGIS styles).

* 
  Every Building in America


  * `Building footprints <https://github.com/Microsoft/USBuildingFootprints/>`_ collected by Microsoft, but presentation by New York Times `highlights society-nature interactions <https://www.nytimes.com/interactive/2018/10/12/us/map-of-every-building-in-the-united-states.html>`_.
  * 
    .. image:: http://www.zzzhou.me/images/2020/11/17/NYT-MS-History.png
       :target: http://www.zzzhou.me/images/2020/11/17/NYT-MS-History.png
       :alt: NYT-MS-History

* 
  A Deceptively Simple Problem

..

      We want to show data on a map in a way that is **both accurate and informative**.



* Classification

  * The greater the accuracy of a **choropleth** or other class-based map, the less itâ€™s possible generalise from it.
  * There is no 'right' way to group data into an arbitrary number of discrete classes (a.k.a. to generalise).

* Different ways of representation will be totally different

  * Judgement should based on distribution
  * Six Views of Employment

..

   ..

      Different colour and break schemes not only give us different **views** of the data, they give us different **understandings** of the data! Each potentially changes how the data looks and, consequently, how we perceive the distribution.



* Maps have a 'Rhetoric' `Do maps lie? <https://www.youtube.com/watch?v=G0_MBrJnRq0>`_ it always helps to look at a map with a critical  eye.

Exploratory Data Analysis
~~~~~~~~~~~~~~~~~~~~~~~~~


* Epicyclic Feedback

.. list-table::
   :header-rows: 1

   * - 
     - Set Expectations
     - Collect Information
     - Revise Expectations
   * - Question
     - Question is of interest to audience
     - Literature search/experts
     - Sharpen question
   * - EDA
     - Data are appropriate for question
     - Make exploratory plots
     - Refine question or collect more data
   * - Modelling
     - Primary model answers question
     - Fit secondary models / analysis
     - Revise model to include more predictors
   * - Interpretation
     - Interpretation provides specific and meaningful answer
     - Interpret analyses with focus on effect and uncertainty
     - Revise EDA and/or models to provide more specific answers
   * - Communication
     - Process & results are complete and meaningful
     - **Seek feedback**
     - Revises anlyses or approach to presentation



* 
  Approaching EDA


  * From: `EDAâ€”Don't ask how, ask what <https://medium.com/towards-artificial-intelligence/exploratory-data-analysis-eda-dont-ask-how-ask-what-2e29703fb24a>`_\ :
  * Descriptive Statistics: get a high-level understanding of your dataset
  * Missing values: come to terms with how bad your dataset is
  * Distributions and Outliers: and why countries that insist on using different units make our jobs so much harder
  * Correlations: and why sometimes even the most obvious patterns still require some investigating

    * Preview data
    * Check total number of entries and column types
    * Check any null values
    * Check duplicate entries
    * Plot distribution of numeric data (univariate and pairwise joint distribution)
    * Plot count distribution of categorical data
    * Analyse time series of numeric data by daily, monthly and yearly frequencies

* 
  Signal & Noise  


  * Starting at a chart 

    * The problem of relying on statistics alone was amply illustrated by Anscombe's Quartet (1973)...
    * We *are not* very good at looking at spreadsheets. 
    * We *are* very good at spotting patterns visually.
    * ^ Or, as Albert Einstein reportedly said: "If I can't picture it, I can't understand it."

  * What Makes a Good Plot?

    * Serves a **purpose** â€” it is clear how it advances the argument in a way that could not be done in the text *alone*.
    * Contains only what is **relevant** â€” zeroes in on what the reader *needs* and is not needlessly cluttered.
    * Uses precision that is **meaningful** â€” 
    * Far too many charts or tables could be easily written up in a single sentence.
    * Far too many charts or tables contain redundancy, clutter, and 'flair'.\
    * Don't report average height of your class to sub-millimeter level accuracy, or lat/long to sub-atomic scale.

  * The Purpose of a Chart

    * Think of a chart or table as part of your â€˜argumentâ€™ â€“ if you canâ€™t tell me how a figure advances your argument (or if your explanation is more concise than the figure) then you probably donâ€™t need it.
    * Identify & prioritise the relationships in the data.
    * Choose a chart type/chart symbology that gives emphasis to the most important relationships.

  * Beyond the Chart
  * Why a table is sometimes better than a chart:

    * You need to present data values with greater detail
    * You need to enable readers to draw comparisons between data values
    * You need to present the same data in multiple ways (\ *e.g.* raw number *and* percentage)
    * You want to show many dimensions for a small number of observations
    * è¡¨æ ¼çš„æ ¼å¼  æ•°å­—å¯¹é½æ–¹å¼ ä¿¡æ¯ä¸é‡å¤ ä¸é—æ¼

Links


* `Pandas Reference <https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.html>`_
* `A Guide to EDA in Python <https://levelup.gitconnected.com/cozy-up-with-your-data-6aedfb651172>`_ (Looks very promising)
* `EDA with Pandas on Kaggle <https://www.kaggle.com/kashnitsky/topic-1-exploratory-data-analysis-with-pandas>`_
* `EDA Visualisation using Pandas <https://towardsdatascience.com/exploratory-data-analysis-eda-visualization-using-pandas-ca5a04271607>`_
* `Python EDA Analysis Tutorial <https://www.datacamp.com/community/tutorials/exploratory-data-analysis-python>`_
* `Better EDA with Pandas Profiling <https://towardsdatascience.com/a-better-eda-with-pandas-profiling-e842a00e1136>`_ **[Requires module installation]**
* `EDA: DataPrep.eda vs Pandas-Profiling <https://towardsdatascience.com/exploratory-data-analysis-dataprep-eda-vs-pandas-profiling-7137683fe47f>`_ **[Requires module installation]**
* `A Data Science Project for Beginners (EDA) <https://medium.com/analytics-vidhya/a-data-science-project-for-beginners-exploratory-data-analysis-eda-d334f58f94ee>`_
* `EDA: A Pracitcal Guide and Template for Structured Data <https://towardsdatascience.com/exploratory-data-analysis-eda-a-practical-guide-and-template-for-structured-data-abfbf3ee3bd9>`_
* `EDAâ€”Don't ask how, ask what <https://medium.com/towards-artificial-intelligence/exploratory-data-analysis-eda-dont-ask-how-ask-what-2e29703fb24a>`_ (Part 1)
* `Preparing your Dataset for Modeling â€“Â Quickly and Easily <https://medium.com/towards-artificial-intelligence/preparing-your-dataset-for-modeling-quickly-and-easily-c8c1b89fdb2e>`_ (Part 2)
* `Handling Missing Data <https://towardsdatascience.com/handling-missing-data-for-a-beginner-6d6f5ea53436>`_
* `Introduction to Exploratory Data Analysis (EDA) <https://medium.com/code-heroku/introduction-to-exploratory-data-analysis-eda-c0257f888676>`_

Exploratory Spatial Data Analysis
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


* PySAL

{{Mind-Map}}
PySAL
    libpysal
        weights
            Distance Weights
            Continguity Weights
    explore
        esda
        inequality
        pointpats
        ...
    model
        mgwr
        spglm
        spreg
        ...
    viz
        legendgram
        mapclassify
        splot


* `EDA with Pandas on Kaggle <https://www.kaggle.com/kashnitsky/topic-1-exploratory-data-analysis-with-pandas>`_
* `EDA Visualisation using Pandas <https://towardsdatascience.com/exploratory-data-analysis-eda-visualization-using-pandas-ca5a04271607>`_
* `Python EDA Analysis Tutorial <https://www.datacamp.com/community/tutorials/exploratory-data-analysis-python>`_
* `Better EDA with Pandas Profiling <https://towardsdatascience.com/a-better-eda-with-pandas-profiling-e842a00e1136>`_ **[Requires module installation]**
* `Visualising Missing Data <https://geopandas.org/mapping.html##missing-data>`_
* `Choosing Map Colours <https://geopandas.org/mapping.html##choosing-colors>`_

Readings
^^^^^^^^

Dignazio 2020
~~~~~~~~~~~~~

[@dignazio:2020, chap. 6] **The Numbers Don't Speak for Themselves** in *Data Feminism*\ ; `Pre-review URL <https://bookbook.pubpub.org/pub/6ui5n4vo>`_

Elwood 2017
~~~~~~~~~~~

[@Elwood:2017] `DOI <https://doi.org/10.1080/13658816.2017.1334892>`_
